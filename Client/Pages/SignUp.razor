@page "/signup"
@inject HttpClient Http

<h3>Sign Up</h3>

<input placeholder="Full Name" @bind="_fullName" class="form-control mb-2" />
<input placeholder="Email" @bind="_email" type="email" class="form-control mb-2" />
<input placeholder="Phone Number" @bind="_phoneNumber" class="form-control mb-2" />
<input placeholder="Password" @bind="_password" type="password" class="form-control mb-2" />

<button class="btn btn-success w-100" @onclick="Register">Sign Up</button>

@if (!string.IsNullOrEmpty(_message))
{
    <div class="alert alert-info mt-2">@_message</div>
}

@code {
    private string _fullName = string.Empty;
    private string _email = string.Empty;
    private string _phoneNumber = string.Empty;
    private string _password = string.Empty;
    private string _message = string.Empty;

    private async Task Register()
    {
        var command = new
        {
            FullName = _fullName,
            Email = _email,
            PhoneNumber = _phoneNumber,
            Password = _password
        };

        try
        {
            var response = await Http.PostAsJsonAsync("api/guests/register", command);
            if (response.IsSuccessStatusCode)
            {
                _message = "Registration successful!";
                _fullName = _email = _phoneNumber = _password = string.Empty;
            }
            else
            {
                var error = await response.Content.ReadAsStringAsync();
                _message = $"Error: {error}";
            }
        }
        catch (Exception ex)
        {
            _message = $"Exception: {ex.Message}";
        }
    }
}
