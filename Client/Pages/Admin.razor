@page "/admin"

<h3 class="mb-4">Admin - Manage Rooms</h3>

@if (!string.IsNullOrEmpty(_message))
{
    <div class="alert alert-info">@_message</div>
}

<div class="card mb-5 p-4 shadow-sm">
    <h5 class="mb-3">Create / Edit Room</h5>
    <div class="row mb-3">
        <div class="col-md-4">
            <label class="form-label">Room Number</label>
            <input @bind="_roomNumber" placeholder="e.g. 101" class="form-control" />
        </div>
        <div class="col-md-4">
            <label class="form-label">Capacity</label>
            <input type="number" @bind="_capacity" class="form-control" />
        </div>
        <div class="col-md-4">
            <label class="form-label">Price per Night</label>
            <input type="number" step="0.01" @bind="_pricePerNight" class="form-control" />
        </div>
    </div>

    <div class="d-flex gap-2">
        <button @onclick="CreateRoom" class="btn btn-success">Create</button>
        <button @onclick="EditRoom" class="btn btn-warning">Edit</button>
        <button @onclick="DeleteRoom" class="btn btn-danger">Delete</button>
        <button @onclick="ShowRooms" class="btn btn-primary ms-auto">Show all Rooms</button>
    </div>
</div>

<!-- Example Table for rooms with mock data -->
<div class="card p-3 shadow-sm">
    <h5 class="mb-3">All Rooms</h5>
    <table class="table table-striped table-hover">
        <thead class="table-dark">
            <tr>
                <th>Room Number</th>
                <th>Capacity</th>
                <th>Price per Night</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>101</td>
                <td>2</td>
                <td>$120</td>
                <td>
                    <button class="btn btn-sm btn-warning me-1">Edit</button>
                    <button class="btn btn-sm btn-danger">Delete</button>
                </td>
            </tr>
            <tr>
                <td>102</td>
                <td>4</td>
                <td>$200</td>
                <td>
                    <button class="btn btn-sm btn-warning me-1">Edit</button>
                    <button class="btn btn-sm btn-danger">Delete</button>
                </td>
            </tr>
        </tbody>
    </table>
</div>

@code {
    private string _roomNumber = string.Empty;
    private int _capacity;
    private decimal _pricePerNight;
    private string _message = string.Empty;

    [Inject] private HttpClient Http { get; set; } = default!;

    private async Task CreateRoom()
    {
        var command = new
        {
            Number = _roomNumber,
            Capacity = _capacity,
            PricePerNight = _pricePerNight
        };

        try
        {
            var response = await Http.PostAsJsonAsync("api/rooms", command);

            if (response.IsSuccessStatusCode)
            {
                _message = "Room created successfully!";
                // Clear form
                _roomNumber = string.Empty;
                _capacity = 0;
                _pricePerNight = 0;
            }
            else
            {
                _message = $"Error: {response.ReasonPhrase}";
            }
        }
        catch (Exception ex)
        {
            _message = $"Exception: {ex.Message}";
        }
    }

    private async Task EditRoom()
    {

    }

    private async Task DeleteRoom()
    {

    }

    private async Task ShowRooms()
    {
        
    }
}
